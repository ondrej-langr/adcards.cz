import{r as n,e as x,_ as D,h as F,u as U,a8 as A,i as P,a as R,aF as z,j as s,A as E,T as K,o as h,aA as B,x as b,B as W,p as k,L as q,O as G}from"./index-yOKIGyhs.js";import{L as _}from"./LanguageSelect-6tvgF7cz.js";import{u as H}from"./useRequestWithNotifications-FyVDP3uy.js";import{u as Q}from"./use-disclosure-kjKicoPJ.js";import{T as t}from"./Table-4rjFBSvi.js";import{T as $}from"./Textarea-ClV9ngk2.js";import{L as J}from"./LoadingOverlay-mFMpS3gx.js";import"./Skeleton-ai2isshM.js";import"./Select-Tmriee6U.js";import"./extends-dGVwEr9R.js";import"./Overlay-cDVy-Pzy.js";const V=(a,d)=>{const m=n.useCallback(()=>x.generalTranslations.getManyForLanguage(a).then(({data:u})=>u.data),[a]),o=n.useMemo(()=>["generalTranslations",a],[a]),l=D(o,m,{enabled:!!a,...d});return n.useMemo(()=>({...l,key:o}),[l,o])},cs=F("/_authorized/settings/translations/$lang/")({component:X});function X(){var y;const{t:a}=U(),d=A(),m=P(),{lang:o}=R({from:z.id}),l=H(),[u,{open:L,close:v}]=Q(!1),[C,f]=n.useState(!1),{data:r,isLoading:N,refetch:p}=V(o,{refetchOnMount:!u,refetchOnWindowFocus:!u}),[i,T]=n.useState(r),S=n.useMemo(()=>Object.entries(i||{}).sort(([e],[c])=>e.localeCompare(c)),[i]),I=n.useCallback(async(e,c)=>{T({...i||{},[e]:c})},[i]),j=async e=>{(r==null?void 0:r[e])!=i[e]&&(f(!0),await l({title:"Saving",message:a("Saving, please wait..."),successMessage:a("Key translated!")},async()=>{await x.generalTranslations.update(e,i[e],o),await p(),f(!1),v()}))};n.useEffect(()=>{T(r)},[r]);const M=n.useCallback(e=>async()=>{if(confirm(a("Do you really want to delete this key for ALL languages?")))try{l({title:"Deleting",message:a("Deleting selected key, please wait..."),successMessage:a("Key deleted!")},async()=>{await x.generalTranslations.delete(e),await p()})}catch{}},[a,p]),w=s.jsxs(t.Tr,{children:[s.jsx(t.Th,{children:a("Translation key")}),s.jsx(t.Th,{className:"w-full max-w-[350px]",children:a("Translation value")}),s.jsx(t.Th,{className:"w-full max-w-[100px] opacity-0",children:"Tools"})]}),O=S.map(([e,c])=>s.jsxs(t.Tr,{children:[s.jsx(t.Td,{className:"align-top",children:e}),s.jsx(t.Td,{className:"w-full max-w-[350px]",children:s.jsx($,{onFocus:L,onBlur:()=>j(e),onChange:g=>I(e,g.currentTarget.value),onKeyDown:g=>{g.key==="Enter"&&j(e)},value:c,placeholder:e})}),s.jsx(t.Td,{className:"w-full max-w-[100px] align-baseline",children:s.jsx(E,{onClick:M(e),color:"red",size:"lg",children:s.jsx(K,{size:20})})})]},e));return s.jsxs(h,{children:[s.jsx(h.Header,{children:s.jsxs(B,{justify:"space-between",mb:"md",mt:"md",children:[s.jsx(_,{label:"",value:o,disabledOptions:[(y=d.application)==null?void 0:y.i18n.default],onChange:e=>e&&m({to:b.settings.translations(e).list})}),s.jsx(W,{to:b.settings.translations(o).create,color:"green",leftSection:s.jsx(k,{}),component:q,children:a("Add new")})]})}),s.jsxs(h.Content,{children:[s.jsx(J,{visible:N||C,overlayProps:{blur:2}}),s.jsxs(t,{verticalSpacing:"lg",children:[s.jsx(t.Thead,{children:w}),s.jsx(t.Tbody,{children:O}),s.jsx(t.Tfoot,{children:w})]}),s.jsx(G,{})]})]})}export{cs as Route};
