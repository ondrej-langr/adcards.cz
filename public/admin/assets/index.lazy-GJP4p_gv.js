import{r as n,e as x,aJ as D,h as U,u as F,a1 as K,i as P,a as R,aK as z,j as s,A,T as E,o as h,aw as B,x as b,B as W,p as k,L as q,O as G}from"./index-UkeQhmow.js";import{L as H}from"./LanguageSelect-Jej8Jmsy.js";import{u as J}from"./useRequestWithNotifications-UP2luH2G.js";import{u as Q}from"./extends-qemKJW_u.js";import{T as t}from"./Table-suaNUuwQ.js";import{T as _}from"./Textarea-mbbkmEOn.js";import{L as $}from"./LoadingOverlay-yYE9WfL0.js";import"./Skeleton-VlALSyZX.js";import"./Select-3J8J3tZj.js";import"./ScrollArea-n1YaU9Cl.js";import"./Overlay-P14s14uU.js";const V=(a,d)=>{const m=n.useCallback(()=>x.generalTranslations.getManyForLanguage(a).then(({data:u})=>u.data),[a]),o=n.useMemo(()=>["generalTranslations",a],[a]),l=D(o,m,{enabled:!!a,...d});return n.useMemo(()=>({...l,key:o}),[l,o])},cs=U("/_authorized/settings/translations/$lang/")({component:X});function X(){var y;const{t:a}=F(),d=K(),m=P(),{lang:o}=R({from:z.id}),l=J(),[u,{open:L,close:v}]=Q(!1),[C,f]=n.useState(!1),{data:r,isLoading:N,refetch:p}=V(o,{refetchOnMount:!u,refetchOnWindowFocus:!u}),[i,T]=n.useState(r),S=n.useMemo(()=>Object.entries(i||{}).sort(([e],[c])=>e.localeCompare(c)),[i]),I=n.useCallback(async(e,c)=>{T({...i||{},[e]:c})},[i]),j=async e=>{(r==null?void 0:r[e])!=i[e]&&(f(!0),await l({title:"Saving",message:a("Saving, please wait..."),successMessage:a("Key translated!")},async()=>{await x.generalTranslations.update(e,i[e],o),await p(),f(!1),v()}))};n.useEffect(()=>{T(r)},[r]);const M=n.useCallback(e=>async()=>{if(confirm(a("Do you really want to delete this key for ALL languages?")))try{l({title:"Deleting",message:a("Deleting selected key, please wait..."),successMessage:a("Key deleted!")},async()=>{await x.generalTranslations.delete(e),await p()})}catch{}},[a,p]),w=s.jsxs(t.Tr,{children:[s.jsx(t.Th,{children:a("Translation key")}),s.jsx(t.Th,{className:"w-full max-w-[350px]",children:a("Translation value")}),s.jsx(t.Th,{className:"w-full max-w-[100px] opacity-0",children:"Tools"})]}),O=S.map(([e,c])=>s.jsxs(t.Tr,{children:[s.jsx(t.Td,{className:"align-top",children:e}),s.jsx(t.Td,{className:"w-full max-w-[350px]",children:s.jsx(_,{onFocus:L,onBlur:()=>j(e),onChange:g=>I(e,g.currentTarget.value),onKeyDown:g=>{g.key==="Enter"&&j(e)},value:c,placeholder:e})}),s.jsx(t.Td,{className:"w-full max-w-[100px] align-baseline",children:s.jsx(A,{onClick:M(e),color:"red",size:"lg",children:s.jsx(E,{size:20})})})]},e));return s.jsxs(h,{children:[s.jsx(h.Header,{children:s.jsxs(B,{justify:"space-between",mb:"md",mt:"md",children:[s.jsx(H,{label:"",value:o,disabledOptions:[(y=d.application)==null?void 0:y.i18n.default],onChange:e=>e&&m({to:b.settings.translations(e).list})}),s.jsx(W,{to:b.settings.translations(o).create,color:"green",leftSection:s.jsx(k,{}),component:q,children:a("Add new")})]})}),s.jsxs(h.Content,{children:[s.jsx($,{visible:N||C,overlayProps:{blur:2}}),s.jsxs(t,{verticalSpacing:"lg",children:[s.jsx(t.Thead,{children:w}),s.jsx(t.Tbody,{children:O}),s.jsx(t.Tfoot,{children:w})]}),s.jsx(G,{})]})]})}export{cs as Route};
