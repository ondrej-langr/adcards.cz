import{S as z,V as te,W as se,Y as I,Z as A,R as j,_ as ae,I as ne,K as re,$ as oe,a0 as ie,a1 as le,j as t,o as _,a2 as ce,B as w,L as me,D as K,a3 as Q,u as C,M as c,H as $,z as T,a4 as de,r as y,a5 as H,l as x,b as ue,s as pe,a6 as k,c as ge,a7 as fe,a8 as Ee,e as R,g as xe,i as Se,m as he,X as ye,p as Ne}from"./index-SAZ6haNj.js";import{T as je}from"./TableView-kVLwB8nX.js";import{a as Te,u as ve}from"./useModelItems-twPoOEQZ.js";import{u as Y}from"./useRequestWithNotifications-h9wK2ZZ3.js";import{A as Ie}from"./AsideItemWrap-ptwod5gA.js";import{L as _e}from"./LanguageSelect-MtCN2Zrq.js";import{I as Ce}from"./ImageSelect-3Gp8KeLo.js";import{R as be}from"./Repeater-vdghZSWi.js";import{T as Le}from"./Textarea-DXEk40Sb.js";import{S as Oe}from"./Select-rg4I4KJ2.js";import"./ItemsMissingMessage-kmo3gTn6.js";import"./Skeleton-C4hdwXqm.js";import"./use-disclosure-T47VtGKG.js";import"./Drawer-sFfJ0lpG.js";import"./NativeScrollArea-YDPG7T6l.js";import"./use-window-event-PmHn1Oon.js";import"./Overlay-6lSEz1if.js";import"./Flag-8M8pVeR5.js";import"./FileList-mh70E_HU.js";function Ae(e,s){return e in s.breakpoints?z(s.breakpoints[e]):z(e)}function Pe(e,s){const n=e.map(i=>({value:i,px:Ae(i,s)}));return n.sort((i,l)=>i.px-l.px),n}function P(e){return typeof e=="object"&&e!==null?"base"in e?e.base:void 0:e}function De({spacing:e,verticalSpacing:s,cols:n,selector:i}){var p;const l=te(),m=s===void 0?e:s,u=se({"--sg-spacing-x":I(P(e)),"--sg-spacing-y":I(P(m)),"--sg-cols":(p=P(n))==null?void 0:p.toString()}),d=A(l.breakpoints).reduce((o,a)=>(o[a]||(o[a]={}),typeof e=="object"&&e[a]!==void 0&&(o[a]["--sg-spacing-x"]=I(e[a])),typeof m=="object"&&m[a]!==void 0&&(o[a]["--sg-spacing-y"]=I(m[a])),typeof n=="object"&&n[a]!==void 0&&(o[a]["--sg-cols"]=n[a]),o),{}),f=Pe(A(d),l).filter(o=>A(d[o.value]).length>0).map(o=>({query:`(min-width: ${l.breakpoints[o.value]})`,styles:d[o.value]}));return j.createElement(ae,{styles:u,media:f,selector:i})}var X={root:"m-2415a157"};const Re={cols:1,spacing:"md"},G=ne((e,s)=>{const n=re("SimpleGrid",Re,e),{classNames:i,className:l,style:m,styles:u,unstyled:d,vars:r,cols:f,verticalSpacing:p,spacing:o,...a}=n,E=oe({name:"SimpleGrid",classes:X,props:n,className:l,style:m,classNames:i,styles:u,unstyled:d,vars:r}),S=ie();return j.createElement(j.Fragment,null,j.createElement(De,{...n,selector:`.${S}`}),j.createElement(le,{ref:s,...E("root",{className:S}),...a}))});G.classes=X;G.displayName="@mantine/core/SimpleGrid";const we=()=>t.jsx(_,{children:t.jsx("div",{className:"w-full h-full px-5 flex",children:t.jsxs("div",{className:"m-auto text-center",children:[t.jsx("div",{children:t.jsx(ce,{size:50})}),t.jsx("h1",{className:"max-w-lg",children:"You don't have required permissions to access this page"}),t.jsx(w,{component:me,to:"/",children:"Go home"})]})})}),Ge=()=>{const{control:e}=K();return t.jsx(t.Fragment,{children:t.jsx(Q,{name:"content.data",control:e,render:({field:{onChange:s,value:n}})=>t.jsx(Ce,{label:"Image",onChange:s,selected:n})})})},Fe=[{type:"string",hide:!1,name:"value",primaryString:!1,readonly:!1,required:!0}],Me=()=>{const{t:e}=C();return t.jsx(be,{name:"content",label:e(c.VALUE),placement:$.MAIN,columns:Fe})},We=()=>{const{t:e}=C(),{register:s}=K();return t.jsx(Le,{autosize:!0,label:e(c.VALUE),minRows:4,...s("content.data")})},D=T.string({required_error:c.FIELD_REQUIRED}).min(1,c.FIELD_REQUIRED),qe=T.object({id:T.any().optional(),name:D,slug:D,content:T.object({type:D,data:T.any({required_error:c.FIELD_REQUIRED})})}),Be=({optionToEdit:e,onOptionUpdateOrCreate:s})=>{var M,W,q,B;const n=de(),i=e===void 0,[l,m]=y.useState((W=(M=n.application)==null?void 0:M.i18n)==null?void 0:W.default),u=H(),{data:d}=Te(x.SETTINGS,e,{language:l}),{t:r}=C(),f=Y(),p=ue({defaultValues:{},resolver:pe(qe)}),{register:o,reset:a,control:E,handleSubmit:S,setValue:v,formState:h}=p,N=u==null?void 0:u.can({action:"create",targetEntityTableName:x.SETTINGS});y.useEffect(()=>{e?d&&a(d):a({})},[d,a,e]);const b=k({name:"content.type",control:E}),F=k({name:"slug",control:E}),Z=async g=>{try{f({title:r(i?c.SELECT_OPTION_ADD_NEW_WORKING:c.SELECT_OPTION_UPDATE_WORKING),message:r(c.PLEASE_WAIT),successMessage:r(i?c.SELECT_OPTION_ADD_NEW_DONE:c.SELECT_OPTION_UPDATE_DONE)},async()=>{if(i)await R.settings.create(g);else{const{id:L,...O}=g;await R.settings.update(e,O,{language:l})}await s()})}catch{}};return t.jsx(ge,{...p,children:t.jsx(Ie,{title:i?"Create an option":"Update an option",className:" overflow-auto",children:t.jsxs("form",{className:"h-full px-3",onSubmit:S(Z),children:[t.jsxs(G,{cols:1,spacing:"sm",children:[N&&t.jsxs(t.Fragment,{children:[t.jsx(Q,{name:"content.type",control:E,render:({field:{name:g,onChange:L,onBlur:O,value:J}})=>{var U,V;return t.jsx(Oe,{placeholder:"Select type",name:g,onChange:ee=>{L(ee),v("content.data",void 0)},onBlur:O,value:J,label:"Select datatype",data:[{value:"list",label:"List"},{value:"textArea",label:"Long text"},{value:"image",label:"Image"}],error:typeof((U=h.errors.content)==null?void 0:U.type)=="object"?(V=h.errors.content)==null?void 0:V.type.message:void 0})}}),(((q=n.application)==null?void 0:q.i18n.languages.length)??0)>1&&t.jsx(_e,{value:l,onChange:g=>g&&m(g),className:"w-full",comboboxProps:{shadow:"xl"},pt:"md",disabled:!e})]}),t.jsx(fe,{label:"Label",...o("name",{onChange(g){i&&v("slug",Ee(g.target.value,{replacement:"_",lower:!0,trim:!0}))}}),description:F?t.jsxs(t.Fragment,{children:["Slug: ",F]}):void 0,inputWrapperOrder:["label","input","description","error"],error:(B=h.errors.name)==null?void 0:B.message}),t.jsxs("div",{children:[b==="list"&&t.jsx(Me,{}),b==="textArea"&&t.jsx(We,{}),b==="image"&&t.jsx(Ge,{})]})]}),t.jsx("div",{className:"right-0 mt-5 rounded-lg pb-4",children:t.jsx(w,{className:"mr-auto block",type:"submit",color:"green",loading:h.isSubmitting,children:r(e?"Save":"Create")})})]})})})},ct=xe("/_authorized/settings/system/")({component:()=>{const{user:e}=Se();return!e||!he({userRole:e.role,action:"read",targetEntityTableName:x.SETTINGS})?t.jsx(we,{}):t.jsx(Ve,{})}}),Ue=[{type:"string",admin:{editor:{placement:$.MAIN,width:12},fieldType:"normal",isHidden:!1},fieldName:"name",hide:!1,localized:!1,name:"jmeno",primaryString:!1,readonly:!1,required:!0,title:"dsafasd",unique:!1}];function Ve(){const{t:e}=C(),s=H(),[n,i]=y.useState(1),{data:l,refetch:m,isLoading:u,isError:d}=ve(x.SETTINGS,{params:{page:n}}),[r,f]=y.useState(),p=Y(),o=s==null?void 0:s.can({action:"create",targetEntityTableName:x.SETTINGS}),a=s==null?void 0:s.can({action:"update",targetEntityTableName:x.SETTINGS}),E=s==null?void 0:s.can({action:"delete",targetEntityTableName:x.SETTINGS}),S=y.useCallback(N=>{f(N)},[]),v=y.useCallback(async N=>{if(confirm(e(c.ON_DELETE_REQUEST_PROMPT)))try{p({title:e(c.PLEASE_WAIT),message:e(c.SELECT_OPTION_DELETE_WORKING),successMessage:e(c.SELECT_OPTION_DELETE_DONE)},async()=>{await R.settings.delete(N),await m()})}catch{}},[e,p,m]),h=r!==void 0?t.jsx(Be,{optionToEdit:r==="new"?void 0:r,onOptionUpdateOrCreate:async()=>{await m(),f(void 0)}}):null;return t.jsxs(_,{rightAsideOutlet:h,rightAsideClassName:"w-[500px]",children:[t.jsx(_.Header,{children:o||a&&r!==void 0?t.jsx(w,{color:r!==void 0?"red":"green",leftSection:r!==void 0?t.jsx(ye,{}):t.jsx(Ne,{}),onClick:()=>f(r!==void 0?void 0:"new"),className:"block mb-3 ml-auto",children:e(r!==void 0?"Close":"Add new")}):null}),t.jsx(_.Content,{children:t.jsx(je,{isLoading:u||d,items:(l==null?void 0:l.data)??[],onDeleteAction:E?v:void 0,onEditAction:a?S:void 0,columns:Ue})})]})}export{ct as Route};
