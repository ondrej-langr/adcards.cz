import{r as o,e as g,_ as y,g as C,u as M,a8 as U,h as v,a as G,aF as P,M as n,j as s,A as F,T as W,o as h,aA as K,x as L,B as z,p as B,L as q,O as Q}from"./index-V81NBkkY.js";import{L as H}from"./LanguageSelect-cQyDD5IW.js";import{u as V}from"./useRequestWithNotifications-5KUl0Wuo.js";import{u as Y}from"./use-disclosure-9tVijqur.js";import{T as t}from"./Table-WZjEW_2y.js";import{T as $}from"./Textarea-pbOTemKX.js";import{L as J}from"./LoadingOverlay-9Vdozenv.js";import"./Flag-hAL3FtUS.js";import"./Skeleton-2hbUmUW0.js";import"./Select-o2HnkTTJ.js";import"./Overlay-ZRnzj5aG.js";const X=(a,d)=>{const m=o.useCallback(()=>g.generalTranslations.getManyForLanguage(a).then(({data:T})=>T.data),[a]),r=o.useMemo(()=>["generalTranslations",a],[a]),c=y(r,m,{enabled:!!a,...d});return o.useMemo(()=>({...c,key:r}),[c,r])},us=C("/_authorized/settings/translations/$lang/")({component:Z});function Z(){var A;const{t:a}=M(),d=U(),m=v(),{lang:r}=G({from:P.id}),c=V(),[T,{open:S,close:I}]=Y(!1),[O,f]=o.useState(!1),{data:i,isLoading:_,refetch:p}=X(r,{refetchOnMount:!T,refetchOnWindowFocus:!T}),[l,N]=o.useState(i),w=o.useMemo(()=>Object.entries(l||{}).sort(([e],[u])=>e.localeCompare(u)),[l]),R=o.useCallback(async(e,u)=>{N({...l||{},[e]:u})},[l]),E=async e=>{(i==null?void 0:i[e])!=l[e]&&(f(!0),await c({title:a(n.TRANSLATION_UPDATE_WORKING),message:a(n.PLEASE_WAIT),successMessage:a(n.TRANSLATION_UPDATE_DONE)},async()=>{await g.generalTranslations.update(e,l[e],r),await p(),f(!1),I()}))};o.useEffect(()=>{N(i)},[i]);const b=o.useCallback(e=>async()=>{if(confirm(a(n.TRANSLATION_DELETE_REQUEST_CONFIRM)))try{c({title:a(n.TRANSLATION_DELETE_WORKING),message:a(n.LOADING_MESSAGE),successMessage:a(n.TRANSLATION_DELETE_DONE)},async()=>{await g.generalTranslations.delete(e),await p()})}catch{}},[a,p]),j=s.jsxs(t.Tr,{children:[s.jsx(t.Th,{children:a(n.TRANSLATION_KEY)}),s.jsx(t.Th,{className:"w-full max-w-[350px]",children:a(n.TRANSLATION_VALUE)}),s.jsx(t.Th,{className:"w-full max-w-[100px] opacity-0",children:"Tools"})]}),D=w.map(([e,u])=>s.jsxs(t.Tr,{children:[s.jsx(t.Td,{className:"align-top",children:e}),s.jsx(t.Td,{className:"w-full max-w-[350px]",children:s.jsx($,{onFocus:S,onBlur:()=>E(e),onChange:x=>R(e,x.currentTarget.value),onKeyDown:x=>{x.key==="Enter"&&E(e)},value:u,placeholder:e})}),s.jsx(t.Td,{className:"w-full max-w-[100px] align-baseline",children:s.jsx(F,{onClick:b(e),color:"red",size:"lg",children:s.jsx(W,{size:20})})})]},e));return s.jsxs(h,{children:[s.jsx(h.Header,{children:s.jsxs(K,{justify:"space-between",mb:"md",mt:"md",children:[s.jsx(H,{label:"",value:r,disabledOptions:[(A=d.application)==null?void 0:A.i18n.default],onChange:e=>e&&m({to:L.settings.translations(e).list})}),s.jsx(z,{to:L.settings.translations(r).create,color:"green",leftSection:s.jsx(B,{}),component:q,children:a(n.ADD_NEW_GENERIC)})]})}),s.jsxs(h.Content,{children:[s.jsx(J,{visible:_||O,overlayProps:{blur:2}}),s.jsxs(t,{verticalSpacing:"lg",children:[s.jsx(t.Thead,{children:j}),s.jsx(t.Tbody,{children:D}),s.jsx(t.Tfoot,{children:j})]}),s.jsx(Q,{})]})]})}export{us as Route};
