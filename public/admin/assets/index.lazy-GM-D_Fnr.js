import{r,I as W,K as G,$ as k,R as B,a1 as H,az as J,aA as D,e as O,Q,g as $,u as q,a4 as V,h as Y,a as X,aB as Z,M as d,j as s,A as ee,T as se,o as A,au as te,x as z,B as ae,p as oe,L as ne,aC as re,ay as ie,O as le}from"./index-SAZ6haNj.js";import{a as M,L as ce}from"./LanguageSelect-MtCN2Zrq.js";import{u as ue}from"./useRequestWithNotifications-h9wK2ZZ3.js";import{u as F}from"./use-window-event-PmHn1Oon.js";import{u as de}from"./use-disclosure-T47VtGKG.js";import{T as m}from"./Table-UPGvF0KO.js";import{T as K}from"./Textarea-DXEk40Sb.js";import{L as me,A as ge}from"./LoadingOverlay-r5o9b2jl.js";import"./Flag-8M8pVeR5.js";import"./Skeleton-C4hdwXqm.js";import"./Select-rg4I4KJ2.js";import"./Overlay-6lSEz1if.js";function Te(e,i="use-local-storage"){try{return JSON.stringify(e)}catch{throw new Error(`@mantine/hooks ${i}: Failed to serialize the value`)}}function pe(e){try{return e&&JSON.parse(e)}catch{return e}}function he(e){return{getItem:n=>{try{return window[e].getItem(n)}catch{return console.warn("use-local-storage: Failed to get value from storage, localStorage is blocked"),null}},setItem:(n,g)=>{try{window[e].setItem(n,g)}catch{console.warn("use-local-storage: Failed to set value to storage, localStorage is blocked")}},removeItem:n=>{try{window[e].removeItem(n)}catch{console.warn("use-local-storage: Failed to remove value from storage, localStorage is blocked")}}}}function we(e,i){const c=e==="localStorage"?"mantine-local-storage":"mantine-session-storage",{getItem:l,setItem:n,removeItem:g}=he(e);return function({key:o,defaultValue:u,getInitialValueInEffect:E=!0,deserialize:x=pe,serialize:j=T=>Te(T,i)}){const T=r.useCallback(a=>{let w;try{w=typeof window>"u"||!(e in window)||window[e]===null||!!a}catch{w=!0}if(w)return u;const f=l(o);return f!==null?x(f):u},[o,u]),[N,h]=r.useState(T(E)),p=r.useCallback(a=>{a instanceof Function?h(w=>{const f=a(w);return n(o,j(f)),window.dispatchEvent(new CustomEvent(c,{detail:{key:o,value:a(w)}})),f}):(n(o,j(a)),window.dispatchEvent(new CustomEvent(c,{detail:{key:o,value:a}})),h(a))},[o]),v=r.useCallback(()=>{g(o),window.dispatchEvent(new CustomEvent(c,{detail:{key:o,value:u}}))},[]);return F("storage",a=>{a.storageArea===window[e]&&a.key===o&&h(x(a.newValue??void 0))}),F(c,a=>{a.detail.key===o&&h(a.detail.value)}),r.useEffect(()=>{u!==void 0&&N===void 0&&p(u)},[u,N,p]),r.useEffect(()=>{E&&p(T())},[]),[N===void 0?u:N,p,v]}}function fe(e){return we("localStorage","use-local-storage")(e)}var P={root:"m-dc6f14e2"};const Se={},Ee=J((e,{size:i})=>({root:{"--kbd-fz":D(i,"kbd-fz"),"--kbd-padding":D(i,"kbd-padding")}})),L=W((e,i)=>{const c=G("Kbd",Se,e),{classNames:l,className:n,style:g,styles:S,unstyled:o,vars:u,...E}=c,x=k({name:"Kbd",classes:P,props:c,className:n,style:g,classNames:l,styles:S,unstyled:o,vars:u,varsResolver:Ee});return B.createElement(H,{component:"kbd",ref:i,...x("root"),...E})});L.classes=P;L.displayName="@mantine/core/Kbd";const xe=(e,i)=>{const c=r.useCallback(()=>O.generalTranslations.getManyForLanguage(e).then(({data:g})=>g.data),[e]),l=r.useMemo(()=>["generalTranslations",e],[e]),n=Q(l,c,{enabled:!!e,...i});return r.useMemo(()=>({...n,key:l}),[n,l])},ze=$("/_authorized/settings/translations/$lang/")({component:Ne});function Ne(){var C,y;const{t:e}=q(),i=V(),c=Y(),{lang:l}=X({from:Z.id}),[n,g]=fe({key:"how-to-localizations-dismissed",defaultValue:!1,deserialize:t=>t==="1",serialize:t=>t?"1":"0"}),S=ue(),[o,{open:u,close:E}]=de(!1),[x,j]=r.useState(!1),{data:T,isLoading:N,refetch:h}=xe(l,{refetchOnMount:!o,refetchOnWindowFocus:!o}),[p,v]=r.useState(T),a=r.useMemo(()=>Object.entries(p||{}).sort(([t],[b])=>t.localeCompare(b)),[p]),w=r.useCallback(async(t,b)=>{v({...p||{},[t]:b})},[p]),f=async t=>{(T==null?void 0:T[t])!=p[t]&&(j(!0),await S({title:e(d.TRANSLATION_UPDATE_WORKING),message:e(d.PLEASE_WAIT),successMessage:e(d.TRANSLATION_UPDATE_DONE)},async()=>{await O.generalTranslations.upsert(t,p[t],l),await h(),j(!1),E()}))};r.useEffect(()=>{v(T)},[T]);const R=r.useCallback(t=>async()=>{if(confirm(e(d.TRANSLATION_DELETE_REQUEST_CONFIRM)))try{S({title:e(d.TRANSLATION_DELETE_WORKING),message:e(d.LOADING_MESSAGE),successMessage:e(d.TRANSLATION_DELETE_DONE)},async()=>{await O.generalTranslations.delete(t),await h()})}catch{}},[e,h]),_=s.jsxs(m.Tr,{children:[s.jsxs(m.Th,{className:"w-1/2",children:[M[(C=i.application)==null?void 0:C.i18n.default]??null," ",e(d.TRANSLATION_KEY)]}),s.jsxs(m.Th,{className:"w-1/2",children:[M[l]??null," ",e(d.TRANSLATION_VALUE)]}),s.jsx(m.Th,{className:"w-full max-w-[100px] opacity-0",children:"Tools"})]}),U=a.map(([t,b])=>s.jsxs(m.Tr,{children:[s.jsx(m.Td,{className:"align-top w-1/2",children:s.jsx(K,{autosize:!0,readOnly:!0,minRows:4,value:t,disabled:!0})}),s.jsx(m.Td,{className:"w-1/2",children:s.jsx(K,{onFocus:u,onBlur:()=>f(t),onChange:I=>w(t,I.currentTarget.value),onKeyDown:I=>{I.key==="Enter"&&f(t)},autosize:!0,minRows:4,value:b,placeholder:t})}),s.jsx(m.Td,{className:"w-full max-w-[100px] align-baseline",children:s.jsx(ee,{onClick:R(t),color:"red",size:"lg",children:s.jsx(se,{size:20})})})]},t));return s.jsxs(A,{children:[s.jsx(A.Header,{children:s.jsxs(te,{justify:"space-between",mb:"md",mt:"md",children:[s.jsx(ce,{label:"",value:l,disabledOptions:[(y=i.application)==null?void 0:y.i18n.default],onChange:t=>t&&c({to:z.settings.translations(t).list})}),s.jsx(ae,{to:z.settings.translations(l).create,color:"green",leftSection:s.jsx(oe,{}),component:ne,children:e(d.ADD_NEW_GENERIC)})]})}),s.jsxs(A.Content,{children:[s.jsx(me,{visible:N||x,overlayProps:{blur:2}}),n?null:s.jsx(ge,{icon:s.jsx(re,{}),title:e(d.HOW_TO),withCloseButton:!0,onClose:()=>g(!0),children:s.jsx(ie,{t:e,i18nKey:d.HOW_TO_MESSAGE,components:{kbd:s.jsx(L,{})}})}),s.jsxs(m,{verticalSpacing:"md",children:[s.jsx(m.Thead,{children:_}),s.jsx(m.Tbody,{children:U}),s.jsx(m.Tfoot,{children:_})]}),s.jsx(le,{})]})]})}export{ze as Route};
