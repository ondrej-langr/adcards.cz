import{r as u,u as j,j as t,a6 as k,a7 as F,h as y,k as L,b as P,E as C,o as v,c as z,a4 as N,a8 as D,M as E,A as M,L as J,a9 as R,B as U,O as W,a0 as _,w as B,aa as G,g as H,e as T,ab as q,ac as I}from"./index-UkeQhmow.js";import{I as K}from"./ImageSelect-OrQni5Eo.js";import{u as A}from"./NativeScrollArea-beAZtOJ3.js";import{S as $}from"./Select-3J8J3tZj.js";import{D as Q}from"./Divider-FzsehbAm.js";import"./FileList-oh-Khnf6.js";import"./Modal-0L1jbVT5.js";import"./ItemsMissingMessage-SzV8FphL.js";import"./get-auto-contrast-value-TBhcg1GA.js";import"./Skeleton-VlALSyZX.js";import"./Overlay-P14s14uU.js";import"./ScrollArea-n1YaU9Cl.js";function X(e,a="use-local-storage"){try{return JSON.stringify(e)}catch{throw new Error(`@mantine/hooks ${a}: Failed to serialize the value`)}}function Y(e){try{return e&&JSON.parse(e)}catch{return e}}function Z(e){return{getItem:o=>{try{return window[e].getItem(o)}catch{return console.warn("use-local-storage: Failed to get value from storage, localStorage is blocked"),null}},setItem:(o,l)=>{try{window[e].setItem(o,l)}catch{console.warn("use-local-storage: Failed to set value to storage, localStorage is blocked")}},removeItem:o=>{try{window[e].removeItem(o)}catch{console.warn("use-local-storage: Failed to remove value from storage, localStorage is blocked")}}}}function V(e,a){const r=e==="localStorage"?"mantine-local-storage":"mantine-session-storage",{getItem:c,setItem:o,removeItem:l}=Z(e);return function({key:n,defaultValue:i,getInitialValueInEffect:w=!0,deserialize:m=Y,serialize:h=g=>X(g,a)}){const g=u.useCallback(s=>{let d;try{d=typeof window>"u"||!(e in window)||window[e]===null||!!s}catch{d=!0}if(d)return i;const p=c(n);return p!==null?m(p):i},[n,i]),[S,x]=u.useState(g(w)),b=u.useCallback(s=>{s instanceof Function?x(d=>{const p=s(d);return o(n,h(p)),window.dispatchEvent(new CustomEvent(r,{detail:{key:n,value:s(d)}})),p}):(o(n,h(s)),window.dispatchEvent(new CustomEvent(r,{detail:{key:n,value:s}})),x(s))},[n]),O=u.useCallback(()=>{l(n),window.dispatchEvent(new CustomEvent(r,{detail:{key:n,value:i}}))},[]);return A("storage",s=>{s.storageArea===window[e]&&s.key===n&&x(m(s.newValue??void 0))}),A(r,s=>{s.detail.key===n&&x(s.detail.value)}),u.useEffect(()=>{i!==void 0&&S===void 0&&b(i)},[i,S,b]),u.useEffect(()=>{w&&b(g())},[]),[S===void 0?i:S,b,O]}}function ee(e){return V("localStorage","use-local-storage")(e)}const te=[{value:"en",label:"ðŸ‡¬ðŸ‡§ English"},{value:"cs",label:"ðŸ‡¨ðŸ‡¿ ÄŒesky"},{value:"de",label:"ðŸ‡©ðŸ‡ª German"},{value:"sk",label:"ðŸ‡¸ðŸ‡° Slovensky"}],ae=()=>{const{t:e}=j(),[a,r]=ee({key:k,defaultValue:"en"}),c=o=>{r(o||"en"),F.changeLanguage(o||"en")};return t.jsx($,{label:e("Admin language"),placeholder:e("Select an option"),data:te,value:a,onChange:c})},Se=y("/_authorized/settings/profile/")({component:se}),oe=()=>{const{t:e}=j(),{user:a}=L();return t.jsx(_,{name:"avatar",render:({field:{onChange:r,onBlur:c,value:o}})=>t.jsx(K,{label:e("Avatar"),selected:typeof o=="object"&&"id"in o?o.id:o,multiple:!1,onChange:l=>l&&r(l),onBlur:c,wrapperClassName:B("md:w-3/6 w-full text-left"),classNames:{wrapper:"flex-col items-start gap-3",imageWrapper:"relative w-full aspect-square rounded-prom overflow-hidden"},imageProps:{width:400},placeholderElement:t.jsx("div",{className:"m-auto text-4xl",children:G((a==null?void 0:a.name)||"-- --")}),imageWrapperProps:{disableStyles:!0}})})};function se(){const{user:e}=L(),{t:a}=j(),r=P({defaultValues:e??void 0}),{register:c,handleSubmit:o,watch:l}=r,f=l(),n=u.useMemo(()=>!!Object.keys(C(e,f)).length,[e,f]),i=async w=>{const m="update-profile-settings-notification";H({id:m,loading:!0,title:"Updating",message:a("Updating your data, please wait..."),autoClose:!1,disallowClose:!0});const h=C(e,w);try{await T.profile.update(h),await q(),I({id:m,message:a("Update done!"),autoClose:2e3})}catch{I({id:m,color:"red",message:a("An error happened"),autoClose:2e3})}};return t.jsxs(v,{children:[t.jsx(v.Header,{title:a("My profile")}),t.jsx(v.Content,{children:t.jsx(z,{...r,children:t.jsxs("form",{onSubmit:o(i),className:"mt-6 w-full gap-8 pb-5 flex flex-col items-baseline md:flex-row",autoComplete:"off",children:[t.jsx(oe,{}),t.jsxs("div",{className:"w-full",children:[t.jsxs("div",{className:"flex gap-4 flex-col w-full",children:[t.jsx(N,{label:a("Full name"),className:"w-full",...c("name")}),t.jsx(N,{disabled:!0,label:"Email",className:"w-full",rightSection:t.jsx(D,{label:a(E.CHANGE_PASSWORD),children:t.jsx(M,{component:J,to:"/settings/profile/password/change",className:"w-5 h-5",children:t.jsx(R,{size:17})})}),...c("email")})]}),t.jsx(Q,{label:a(E.ADMIN_PANEL),labelPosition:"left",mt:"xl",mb:"sm"}),t.jsx(ae,{}),t.jsx(U,{className:"mt-5 max-w-[150px]",size:"md",color:"green",type:"submit",disabled:!n,loading:r.formState.isSubmitting,children:a("Save")})]})]})})}),t.jsx(W,{})]})}export{Se as Route};
