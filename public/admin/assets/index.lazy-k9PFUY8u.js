import{h as A,i as w,u as _,r as n,k,l as C,m as l,n as f,j as e,o as c,B as P,p as x,A as U,M as y,e as L}from"./index-yOKIGyhs.js";import{T as i}from"./TableView-YzxR0suN.js";import{f as v}from"./_utils-UdYZV02l.js";import{u as I}from"./useModelItems-swOYtnuG.js";import"./ItemsMissingMessage-BErgMmqr.js";import"./extends-dGVwEr9R.js";import"./Skeleton-ai2isshM.js";import"./use-disclosure-kjKicoPJ.js";import"./Drawer-N9Gfdqty.js";import"./NativeScrollArea-RnWAygQU.js";import"./Overlay-cDVy-Pzy.js";import"./Select-Tmriee6U.js";const K=A("/_authorized/users/")({component:z});function z(){const m=w(),{t:r}=_(),[d,h]=n.useState(1),{user:o}=k(),a=C(l.USERS),{data:t,isLoading:g,isError:j,refetch:R}=I(l.USERS,{params:{page:d}}),u=n.useMemo(()=>{if(!t)return!1;const{data:s,...M}=t;return M},[t]),N=n.useMemo(()=>t!=null&&t.data?t.data.filter(s=>s.id!==(s==null?void 0:s.id)):[],[t,o]),p=f({userRole:o.role,action:"update",targetEntityTableName:l.USERS}),E=()=>m({to:"/users/create"}),S=p?s=>m({to:`/users/${s}`}):void 0,b=p?async s=>{confirm(r(y.ON_DELETE_REQUEST_PROMPT))&&(await L.users.delete(s),R())}:void 0,T=n.useMemo(()=>{if(a)return v(a)},[a]);return e.jsxs(c,{children:[e.jsx(c.Header,{title:r("Users"),classNames:{wrapper:"flex items-center justify-between"},children:(o==null?void 0:o.role)&&f({userRole:o==null?void 0:o.role,action:"create",targetEntityTableName:a.tableName})&&e.jsxs(e.Fragment,{children:[e.jsx(P,{color:"green",className:"font-semibold uppercase hidden md:block",size:"md",onClick:E,leftSection:e.jsx(x,{className:"inline-block h-5 w-5"}),children:e.jsx("span",{className:"hidden md:block",children:r("Add new user")})}),e.jsx(U,{color:"green",className:" block md:hidden",size:"xl",onClick:E,children:e.jsx(x,{className:"inline-block h-7 w-7"})})]})}),e.jsxs(c.Content,{children:[e.jsx(i,{isLoading:g||j,items:N,columns:T||[],onEditAction:S,onDeleteAction:b}),e.jsxs(i.Footer,{children:[u&&e.jsx(i.Metadata,{...u}),e.jsx(i.Pagination,{className:"ml-auto",total:(t==null?void 0:t.last_page)||1,value:d,onChange:h})]})]})]})}export{K as Route};
